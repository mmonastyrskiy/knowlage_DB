Иногда полезно задавать более общие вопросы о содержимом файла, для ответа на которые необязательно во всех подробностях знать структуру. Один такой вопрос: «Есть ли в файле какие-нибудь строки?» Разумеется, сначала нужно решить, что же такое строка. Определим строку неформально – как непрерывную последовательность печатных символов. Часто это определение дополняется условием на минимальную длину и конкретную кодировку. Таким образом, можно было бы поискать последовательности, содержащие по меньшей мере четыре печатных символа ASCII подряд, и вывести результаты на консоль. Поиск таких строк, как правило, никак не связан со структурой файла. Их можно искать как в двоичном ELFфайле, так и в документе Microsoft Word. Утилита strings предназначена специально для выделения строк из содержимого файла, часто безотносительно к формату последнего. Вызов strings с параметрами по умолчанию (не менее четырех символов в 7-битовой кодировке ASCII подряд)


Исторически в применении к исполняемым файлам strings по умолчанию искала последовательности символов только в загружаемых секциях, содержащих инициализированные данные. Поэтому strings должна была уметь разбирать двоичный файл и искать такие секции, для чего использовались библиотеки типа libbfd. Но при разборе ненадежных двоичных файлов уязвимости в библиотеках могли привести к выполнению произвольного кода1 . В итоге поведение strings по умолчанию было изменено, и она стала просматривать весь двоичный файл, а не только секции с инициализированными данными (это то же самое, что запуск с флагом -a). А прежнее поведение эквивалентно заданию флага -d.

К сожалению, хотя некоторые строки выглядят как вывод программы, есть и другие – похожие на имена функций и библиотек. Так что не следует торопиться с выводами о поведении программы. Аналитики часто совершают ошибку, пытаясь что-то сказать о поведении программы на основе распечатки strings. Не забывайте, что наличие строки в двоичном файле еще не означает, что эта строка как-то используется в процессе его работы. В заключение сделаем несколько замечаний об использовании strings:

по умолчанию strings ничего не говорит о том, в каком месте файла находится строка. Задайте флаг -t, если хотите, чтобы strings печатала смещение каждой найденной строки от начала файла; 
► во многих файлах используются альтернативные кодировки. Флаг -e означает, что strings должна искать широкие символы, например в 16-разрядной кодировке 16 Юникод.